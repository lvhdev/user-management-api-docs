<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Life.io User Management API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;ruby&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="ruby">ruby</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="life-io-user-management-api-reference">Life.io User Management API Reference</h1>

<p>Welcome to the Life.io User Management API. Instructions for authentication and all available endpoints are listed below.</p>

<h1 id="authentication">Authentication</h1>

<p>All requests to the User Management API require an API Key and a User Management Admin Token.</p>

<p>The API Key and User Management Admin Token can be obtained from the rails console accessing the appropriate database via the following commands:</p>

<p><code class="prettyprint">ApiKey.create(client_type: &quot;user_management&quot;)</code></p>

<p><code class="prettyprint">UserManagementAdminToken.create</code></p>

<p>This User Management API was designed with the assumption that the API Key and User Management Admin Token would be stored as environment variables within the User Management Dashboard and passed back to the server with each request.</p>

<h1 id="application-users">Application Users</h1>

<h2 id="get-confirmed_at-timestamp">Get confirmed_at timestamp</h2>
<pre class="highlight ruby"><code><span class="kp">include</span> <span class="no">HTTParty</span>

<span class="no">BASE_URL</span> <span class="o">=</span> <span class="s2">"https://hq.life.io/api/user_management/v1"</span>

<span class="vi">@options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">headers: </span><span class="p">{</span>
    <span class="s2">"Authorization"</span><span class="p">:</span> <span class="vi">@user_management_admin_token</span>
  <span class="p">},</span>
  <span class="ss">body: </span><span class="p">{</span>
    <span class="s2">"api_key"</span><span class="p">:</span> <span class="vi">@api_key</span><span class="p">,</span>
    <span class="s2">"application_user"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"email"</span><span class="p">:</span> <span class="no">CGI</span><span class="o">::</span><span class="n">escape</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="nf">email</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="no">HTTParty</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="no">BASE_URL</span><span class="si">}</span><span class="s2">/application_users"</span><span class="p">,</span> <span class="vi">@options</span><span class="p">)</span>

</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://hq.life.io/api/user_management/v1/application_users"</span>
  -X GET
  -d <span class="s2">"api_key=your_api_key
      &amp;application_user[email]=test@test.com"</span>
  -H <span class="s2">"Authorization: Token token=your_user_management_admin_token"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016-11-08</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">14</span><span class="err">:</span><span class="mi">56</span><span class="w"> </span><span class="mi">-060</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>This endpoint retrieves a specific user&rsquo;s confirmed_at timestamp.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://hq.life.io/api/user_management/v1/application_users</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>The application user&rsquo;s email address is used to find the specific user. ID is not accepted.</td>
</tr>
</tbody></table>

<aside class="notice">
Note — the email address must be wrapped in a CGI::escape().
</aside>

<h2 id="delete-a-user">Delete a User</h2>
<pre class="highlight ruby"><code><span class="kp">include</span> <span class="no">HTTParty</span>

<span class="no">BASE_URL</span> <span class="o">=</span> <span class="s2">"https://hq.life.io/api/user_management/v1"</span>

<span class="vi">@options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">headers: </span><span class="p">{</span>
    <span class="s2">"Authorization"</span><span class="p">:</span> <span class="vi">@user_management_admin_token</span>
  <span class="p">},</span>
  <span class="ss">body: </span><span class="p">{</span>
    <span class="s2">"api_key"</span><span class="p">:</span> <span class="vi">@api_key</span><span class="p">,</span>
    <span class="s2">"application_user"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"email"</span><span class="p">:</span> <span class="no">CGI</span><span class="o">::</span><span class="n">escape</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="nf">email</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="no">HTTParty</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="no">BASE_URL</span><span class="si">}</span><span class="s2">/application_users"</span><span class="p">,</span> <span class="vi">@options</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://hq.life.io/api/user_management/v1/application_users"</span>
  -X DELETE
  -d <span class="s2">"api_key=your_api_key
      &amp;application_user[email]=test@test.com"</span>
  -H <span class="s2">"Authorization: Token token=your_user_management_admin_token"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"User deleted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint deletes a user.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE &quot;https://hq.life.io/api/user_management/v1/application_users&quot;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>The application user&rsquo;s email address is used to find the specific user. ID is not accepted.</td>
</tr>
</tbody></table>

<h1 id="branches">Branches</h1>

<h2 id="create-a-branch">Create a Branch</h2>
<pre class="highlight ruby"><code><span class="kp">include</span> <span class="no">HTTParty</span>

<span class="no">BASE_URL</span> <span class="o">=</span> <span class="s2">"https://hq.life.io/api/user_management/v1"</span>

<span class="vi">@options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">headers: </span><span class="p">{</span>
    <span class="s2">"Authorization"</span><span class="p">:</span> <span class="vi">@user_management_admin_token</span>
  <span class="p">},</span>
  <span class="ss">body: </span><span class="p">{</span>
    <span class="s2">"api_key"</span><span class="p">:</span> <span class="vi">@api_key</span><span class="p">,</span>
    <span class="s2">"branch"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"your_branch_name"</span><span class="p">,</span>
      <span class="s2">"company_id"</span><span class="p">:</span> <span class="n">company_id</span><span class="p">,</span>
      <span class="s2">"country"</span><span class="p">:</span> <span class="s2">"your_branch_country"</span><span class="p">,</span>
      <span class="s2">"state"</span><span class="p">:</span> <span class="s2">"your_branch_state"</span><span class="p">,</span>
      <span class="s2">"city"</span><span class="p">:</span> <span class="s2">"your_branch_city"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="no">HTTParty</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="no">BASE_URL</span><span class="si">}</span><span class="s2">/branches"</span><span class="p">,</span> <span class="vi">@options</span><span class="p">)</span>

</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://hq.life.io/api/user_management/v1/branches"</span>
  -X POST
  -d <span class="s2">"api_key=your_api_key
      &amp;branch[name]=your_branch_name
      &amp;branch[company_id]=company_id
      &amp;branch[country]=your_branch_country
      &amp;branch[state]=your_branch_state
      &amp;branch[city]=your_branch_city"</span>
  -H <span class="s2">"Authorization: Token token=your_user_management_admin_token"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"shared_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"registration_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABC12DEFafcdeg123ab456="</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>This endpoint creates a branch.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://hq.life.io/api/user_management/v1/branches</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Required. Name of new branch.</td>
</tr>
<tr>
<td>company_id</td>
<td>Required. Shared_id of the parent company of new branch.</td>
</tr>
<tr>
<td>country</td>
<td>Required. Country where new branch is located.</td>
</tr>
<tr>
<td>state</td>
<td>Required. State where new branch is located.</td>
</tr>
<tr>
<td>city</td>
<td>Required. City where new branch is located.</td>
</tr>
</tbody></table>

<aside class="notice">
Note — the company_id should be the shared_id returned when creating the parent company of this branch. If you have not created the parent company of this branch yet, you must do this step first.
</aside>

<h1 id="companies">Companies</h1>

<h2 id="create-a-company">Create a Company</h2>
<pre class="highlight ruby"><code><span class="kp">include</span> <span class="no">HTTParty</span>

<span class="no">BASE_URL</span> <span class="o">=</span> <span class="s2">"https://hq.life.io/api/user_management/v1"</span>

<span class="vi">@options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">headers: </span><span class="p">{</span>
    <span class="s2">"Authorization"</span><span class="p">:</span> <span class="vi">@user_management_admin_token</span>
  <span class="p">},</span>
  <span class="ss">body: </span><span class="p">{</span>
    <span class="s2">"api_key"</span><span class="p">:</span> <span class="vi">@api_key</span><span class="p">,</span>
    <span class="s2">"company"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"your_company_name"</span>
      <span class="s2">"parent_organization_name"</span><span class="p">:</span> <span class="s2">"parent_org_name"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="no">HTTParty</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="no">BASE_URL</span><span class="si">}</span><span class="s2">/companies"</span><span class="p">,</span> <span class="vi">@options</span><span class="p">)</span>

</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"https://hq.life.io/api/user_management/v1/branches"</span>
  -X POST
  -d <span class="s2">"api_key=your_api_key
      &amp;company[name]=your_company_name
      &amp;company[parent_organization_name]=parent_org_name"</span>
  -H <span class="s2">"Authorization: Token token=your_user_management_admin_token"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"shared_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subdomain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hq"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>This endpoint creates a company.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://hq.life.io/api/user_management/v1/companies</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Required. Name of new company.</td>
</tr>
<tr>
<td>parent_organization_name</td>
<td>Required. Name of the parent organization of the new company.</td>
</tr>
</tbody></table>

<aside class="notice">
Note — Double check the spelling and accuracy of the parent organization name. This name will be used to create the relationship between the new company and its parent org.
</aside>

          <h1 id="errors">Errors</h1>

<p>The Life.io User Management API primarily uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API Key or User Management Admin Token is incorrect.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; You&rsquo;ve provided a user email, company id, or parent organization name that does not match our records.</td>
</tr>
<tr>
<td>422</td>
<td>Invalid &ndash; You didn&rsquo;t include any of the required parameters!</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="ruby">ruby</a>
          </div>
      </div>
    </div>
  </body>
</html>
